<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title></title>
    <link rel="stylesheet" type="text/css" href="semantic/dist/semantic.min.css">
    <script src="https://maps.googleapis.com/maps/api/js"></script>
    <script src="https://code.jquery.com/jquery-1.10.2.js"></script>
    <style> html,
      body,
      #map_canvas {
        margin: 0;
        padding: 0;
        height: 100%
      }
    </style>
  </head>
  <body>
    Lat:
    <input id="lat" name="lat" val="-6.212097566030472" />Long:
    <input id="long" name="long" val="106.84478759765625" />
    <br />
    <br />
    <div id="map_canvas" style="width: 600px; height: 300px;"></div>
    <script type="text/javascript">
      function initialize() {
        // var myLatlng = new google.maps.LatLng(40.713956, -74.006653);
        var myLatlng = new google.maps.LatLng(-6.212097566030472, 106.84478759765625);
        var myOptions = {
          zoom: 8,
          center: myLatlng,
          mapTypeId: google.maps.MapTypeId.ROADMAP
        };
        var map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);

        var marker = new google.maps.Marker({
          draggable: true,
          position: myLatlng,
          map: map,
          title: "Your location"
        });

        google.maps.event.addListener(marker, 'dragend', function(event) {
          document.getElementById("lat").value = event.latLng.lat();
          document.getElementById("long").value = event.latLng.lng();
          sendLocation(event.latLng.lat(),event.latLng.lng())
        });

        google.maps.event.addListener(map, 'click', function(event) {
          document.getElementById("lat").value = event.latLng.lat();
          document.getElementById("long").value = event.latLng.lng();
          marker.setPosition(event.latLng);
          sendLocation(event.latLng.lat(),event.latLng.lng())
        });
      }
      google.maps.event.addDomListener(window, "load", initialize());

      function sendLocation(lat,lng){
        // alert('lat='+lat+' lng='+lng)
        $.post( 'http://localhost:3000/api/restaurant/get_restaurant', {lat: lat,long: lng} )
      }
    </script>
  </body>
  <script
    src="https://code.jquery.com/jquery-3.1.1.min.js"
    integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="
    crossorigin="anonymous"></script>
  <script src="semantic/dist/semantic.min.js"></script>
</html>
